databaseChangeLog:
  - changeSet:
      id: abdel-20251110-004-seed
      author: abdel
      context: seed
      changes:
        - sql:
            splitStatements: true
            stripComments: true
            sql: |
              
              INSERT INTO utilisateur (id, identifiant, nom, prenom, email, date_naissance, ine, role, mot_de_passe_hash) VALUES
              (1,'abdelwaheb.chakour','Chakour','Abdelwaheb','abdelwaheb.chakour@uphf.fr','2005-02-12','INE-ABDEL-0001','ETUDIANT','[$2y$10$uCVixB0M6VW3/Dfxfzd9vuR9p2dH5d0MbQLRH0NUQObvb6KrIjdvi]'),
              (2,'marie.dupont','Dupont','Marie','marie.dupont@uphf.fr','2004-09-21','INE-MARIE-0002','ETUDIANT','[$2y$10$uCVixB0M6VW3/Dfxfzd9vuR9p2dH5d0MbQLRH0NUQObvb6KrIjdvi]'),
              (3,'julien.vion','Vion','Julien','julien.vion@uphf.fr','1985-06-03',NULL,'RESPONSABLE','[$2y$10$cWa8tXRZPmTuDAhRoaGte.KgF9xFeC1njkO/07YIOIhJMIMAEVaBm]')
              ON CONFLICT (id) DO UPDATE SET identifiant=EXCLUDED.identifiant;

              INSERT INTO programme (id, libelle, composante, public) VALUES
              (1,'BUT INFORMATIQUE','IUT','FI')
              ON CONFLICT (id) DO NOTHING;

              INSERT INTO matiere (id, code, libelle) VALUES
              (1,'MAT101','Analyse 1'),
              (2,'INFO201','Programmation 2'),
              (3,'PHY301','Physique générale')
              ON CONFLICT (id) DO UPDATE SET code=EXCLUDED.code, libelle=EXCLUDED.libelle;

              INSERT INTO enseignement (id, code, libelle, id_matiere) VALUES
              (1,'ENS-MAT101-TD1','Analyse 1 — TD',1),
              (2,'ENS-INFO201-TP','Programmation 2 — TP',2),
              (3,'ENS-PHY301-CM','Physique générale — CM',3)
              ON CONFLICT (id) DO UPDATE SET code=EXCLUDED.code, libelle=EXCLUDED.libelle, id_matiere=EXCLUDED.id_matiere;

              INSERT INTO seance (id, date, heure, duree, type, id_programme, id_enseignement, groupes, salles, profs, controle) VALUES
              (1,'2025-10-02','09:00','2 hours','TP',1,2,'G1','B201','Dupont',FALSE),
              (2,'2025-10-03','10:00','1 hour','TD',1,1,'G1','A105','Martin',TRUE),
              (3,'2025-10-05','08:30','1 hour 30 minutes','CM',1,3,'ALL','Amphi','Durand',FALSE),
              (4,'2025-10-06','14:00','1 hour','TD',1,2,'G2','C304','Dupont',FALSE)
              ON CONFLICT (id) DO NOTHING;

              INSERT INTO absence (id, id_utilisateur, id_seance, presence, justification, motif, commentaire) VALUES
              (1,1,1,'ABSENT'::presenceetat,'INCONNU'::justifetat,'Programmation 2','Certificat médical attendu'),
              (2,1,2,'ABSENT'::presenceetat,'NON_JUSTIFIEE'::justifetat,'Analyse 1','Document illisible'),
              (3,1,3,'ABSENT'::presenceetat,'JUSTIFIEE'::justifetat,'Physique','Justificatif familial'),
              (4,1,4,'ABSENT'::presenceetat,'INCONNU'::justifetat,'Programmation 2','En attente de justificatif')
              ON CONFLICT (id) DO NOTHING;

              INSERT INTO justificatif (id, fichier, commentaire, date_soumission, date_maj, motif_libre, id_utilisateur, nom_fichier_original, type_mime) VALUES
              (1, E'\\x255044', 'Certificat médical', NOW(), NOW(), NULL, 1, 'certificat_medical.pdf', 'application/pdf'),
              (2, E'\\x89504E47', 'Photo floue', NOW(), NOW(), NULL, 1, 'photo_justif.png', 'image/png'),
              (3, E'\\x504B03', 'Justificatif compressé', NOW(), NOW(), NULL, 1, 'justif.zip', 'application/zip')
              ON CONFLICT (id) DO NOTHING;

              INSERT INTO justificatifabsence (id_justificatif, id_absence) VALUES
              (1,1),
              (2,2),
              (3,3)
              ON CONFLICT DO NOTHING;

              INSERT INTO historiquedecision (id, action, date_action, motif_decision, id_justificatif, id_auteur) VALUES
              (1,'SOUMISSION'::typedecision,NOW(),'Soumission initiale',1,1),
              (2,'ACCEPTATION'::typedecision,NOW(),'Certificat accepté',1,3),
              (3,'SOUMISSION'::typedecision,NOW(),'Soumission initiale',2,1),
              (4,'DEMANDE_PRECISIONS'::typedecision,NOW(),'Document illisible',2,3),
              (5,'SOUMISSION'::typedecision,NOW(),'Soumission initiale',3,1),
              (6,'REJET'::typedecision,NOW(),'Format non accepté',3,3)
              ON CONFLICT (id) DO NOTHING;